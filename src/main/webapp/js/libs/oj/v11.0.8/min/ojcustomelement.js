/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojcore","ojs/ojlogger","ojs/ojcustomelement-utils","ojs/ojtrace-event","ojs/ojmetadatautils","ojs/ojbootstrap","ojs/ojcore-base"],function(t,e,r,n,i,o,s){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s;const a={};a.proto={getClass:function(t){var e=Object.create(HTMLElement.prototype);this.InitializePrototype(e),e.dispatchEvent=n.traceDispatchEvent(HTMLElement.prototype.dispatchEvent);var i=this.GetMetadata(t);a._enumerateMetadataForKey(e,i,"properties",this.DefinePropertyCallback.bind(this)),a._enumerateMetadataForKey(e,i,"methods",this.DefineMethodCallback.bind(this)),this.AddComponentMethods(e),e.setProperties=function(t){r.CustomElementUtils.getElementBridge(this)._setProperties(this,t)},Object.defineProperty(e,"set",{value:function(t,e){this.setProperty(t,e)}}),Object.defineProperty(e,"unset",{value:function(t){this.setProperty(t,void 0)}}),e.attributeChangedCallback=this.AttributeChangedCallback,e.connectedCallback=this._connectedCallback,e.disconnectedCallback=this._detachedCallback;const o=e.appendChild;e.appendChild=function(t){return r.CustomElementUtils.canRelocateNode(this,t)?o.call(this,t):t};const s=e.insertBefore;e.insertBefore=function(t,e){return r.CustomElementUtils.canRelocateNode(this,t)?s.call(this,t,e):t},e.setAttribute=function(t,e){if("class"===t){const t=r.CustomElementUtils.getClassSet(e);r.CustomElementUtils.getElementState(this).setOuterClasses(t)}else HTMLElement.prototype.setAttribute.call(this,t,e)},e.removeAttribute=function(t){"class"===t?this.setAttribute("class",""):HTMLElement.prototype.removeAttribute.call(this,t)};var l=function(){var t=window.Reflect;return void 0!==t?t.construct(HTMLElement,[],this.constructor):HTMLElement.call(this)},u=this;return Object.defineProperty(l,"observedAttributes",{get:function(){return u.GetAttributes(i)}}),Object.defineProperty(e,"constructor",{value:l,writable:!0,configurable:!0}),l.prototype=e,Object.setPrototypeOf(l,HTMLElement),l},initializeBridge:function(t,e){this.METADATA=this.GetMetadata(e),this._eventListeners={},this.State=r.CustomElementUtils.getElementState(t)},AddComponentMethods:function(t){},AttributeChangedCallback:function(t,n,o){const s=r.AttributeUtils.attributeToPropertyName(t),l=r.CustomElementUtils.getElementBridge(this);if(n!==o||l.State.dirtyProps.has(s)){if(l.State.dirtyProps.delete(s.split(".")[0]),"disabled"===t&&l.ShouldRemoveDisabled()&&l._isDisabledAttributeRemoved())return void(null!=o&&(e.warn("Ignoring 'disabled' attribute change after component initialization. Use element property setter instead."),l._removeDisabledAttribute(this)));if(l.ShouldHandleAttributeChanged(this)){a.__CheckOverlappingAttribute(this,t),null===o&&(o=void 0);var u={detail:{attribute:t,value:o,previousValue:n}};if(this.dispatchEvent(new CustomEvent("attribute-changed",u)),!r.AttributeUtils.getExpressionInfo(o).expr){const e=i.getPropertyMetadata(s,r.CustomElementUtils.getElementProperties(this));e&&this.setProperty(s,a.__ParseAttrValue(this,t,s,o,e)),l.HandleAttributeChanged(this,t,n,o)}}}},CreateComponent:function(t){},DefineMethodCallback:function(t,e,r){},DefinePropertyCallback:function(t,e,r){},GetAttributes:function(t){return t?i.getFlattenedAttributes(t.properties):[]},GetMetadata:function(t){return t[a.DESC_KEY_META]||{}},GetAliasForProperty:function(t){return t},ShouldHandleAttributeChanged:function(t){return this.State.canHandleAttributes()},ShouldCallHandleAttributeChanged:function(t){return this.ShouldHandleAttributeChanged()},HandleAttributeChanged:function(t,e,r,n){},HandleBindingsApplied:function(t,e){},HandleDetached:function(t){},HandleReattached:function(t){},InitializeElement:function(t){},InitializePrototype:function(t){},BatchedPropertySet:function(t,e){for(var r=Object.keys(e),n=0;n<r.length;n++){var i=r[n];t.setProperty(i,e[i])}},GetEventListenerProperty:function(t){var e=r.AttributeUtils.eventListenerPropertyToEventType(t),n=this._eventListeners[e];if(n)return n.getListener()},GetProperty:function(t,e,n){var o=i.getPropertyMetadata(e,r.CustomElementUtils.getElementProperties(t));return r.AttributeUtils.isEventListenerProperty(e)||!o||-1===e.indexOf(".")?n[e]:r.CustomElementUtils.getPropertyValue(n,e)},HandlePropertyChanged:function(t,e,r,n,i,o){var s=i?"external":"internal";a.__FirePropertyChangeEvent(t,e,r,n,s,o)},PlaybackEarlyPropertySets:function(t){if(this._earlySets){const e=r.CustomElementUtils.getElementDescriptor(t.tagName),n=this.GetMetadata(e);for(;this._earlySets.length;){const e=this._earlySets.shift(),i=r.CustomElementUtils.convertEmptyStringToUndefined(t,n.properties[e.property],e.value);t.setProperty(e.property,i)}}},SaveEarlyPropertySet:function(t,e,r){return!this.State.allowPropertySets()&&(this._earlySets||(this._earlySets=[]),this._earlySets.push({property:e,value:r}),!0)},SetEventListenerProperty:function(t,e,n){var i=r.AttributeUtils.eventListenerPropertyToEventType(e),o=this._eventListeners[i];o||(o=this._createEventListenerWrapper(),this._eventListeners[i]=o,t.addEventListener(i,o)),null==n||n instanceof Function?o.setListener(n):a.__ThrowTypeError(t,e,n,"function")},SetProperty:function(e,n,o,s,l){var u=i.getPropertyMetadata(n,r.CustomElementUtils.getElementProperties(e));if(r.AttributeUtils.isEventListenerProperty(n)||!u)e[n]=o;else{var p=e.getProperty(n),c=n.split(".")[0],d=s[c];if(t.CollectionUtils.isPlainObject(d)&&(d=t.CollectionUtils.copyInto({},d,void 0,!0)),!r.ElementUtils.comparePropertyValues(u,o,p)){var h=-1!==n.indexOf(".");if(h&&(this._SKIP_PROP_CHANGE_EVENT=!0),l?this.ValidateAndSetProperty(this.GetAliasForProperty.bind(this),s,n,o,e):a.__SetProperty(this.GetAliasForProperty.bind(this),s,n,o),this._SKIP_PROP_CHANGE_EVENT=!1,h){var y={path:n,value:o,previousValue:p};this.HandlePropertyChanged(e,c,s[c],d,l,y)}return this.State.dirtyProps.add(c),{property:c,propertySet:!0,isSubproperty:h}}}return{property:null,propertySet:!1,isSubproperty:!1}},ShouldRemoveDisabled:function(){return!0},ValidateAndSetProperty:function(t,e,r,n,i){var o=this.ValidatePropertySet(i,r,n);a.__SetProperty(t,e,r,o)},ValidatePropertySet:function(t,n,o){var s=r.CustomElementUtils.getElementProperties(t),l=i.getPropertyMetadata(n,s),u=n.split(".");if(l){if(s[u[0]].readOnly)throw new r.JetElementError(t,`Read-only property '${n}' cannot be set.`);try{i.checkEnumValues(t,n,o,l)}catch(e){throw new r.JetElementError(t,e.message)}return null!=o?a.checkType(t,n,o,l):o}e.warn(r.CustomElementUtils.getElementInfo(t)+": Ignoring property set for undefined property '"+n+"'.")},PostCreate:function(t){t.hasAttribute("disabled")&&this.ShouldRemoveDisabled()&&!this._isDisabledAttributeRemoved()&&this._removeDisabledAttribute(t)},_connected:function(t){const e=this.State;if(e.isComplete())this.HandleReattached(t);else if(e.startCreationCycle(),e.isCreating()){this.InitializeElement(t),e.setBindingProviderCallback(this.PlaybackEarlyPropertySets.bind(this,t));const r=()=>{try{e.getSlotMap(!0);return(this.CreateComponent(t)||Promise.resolve()).then(this.PostCreate.bind(this,t))}catch(t){return Promise.reject(t)}};e.setCreateCallback(r)}},_connectedCallback:function(){r.CustomElementUtils.getElementBridge(this)._connected(this)},_detachedCallback:function(){const t=r.CustomElementUtils.getElementBridge(this),e=t.State;e.isComplete()?t.HandleDetached(this):e.pauseCreationCycle()},_createEventListenerWrapper:function(){var t,e=function(e){t&&t(e)};return e.setListener=function(e){t=e},e.getListener=function(){return t},e},_setProperties:function(t,e){for(var r=[],n={},i=!1,o=Object.keys(e),s=0;s<o.length;s++){var a=o[s];a.indexOf(".")>=0?r.push(a):(n[a]=e[a],i=!0)}i&&this.BatchedPropertySet(t,n);for(var l=0;l<r.length;l++){var u=r[l];t.setProperty(u,e[u])}},_isDisabledAttributeRemoved:function(){return!0===this._disabledProcessed},_removeDisabledAttribute:function(t){this._disabledProcessed=!0,t.removeAttribute("disabled")}},a._enumerateMetadataForKey=function(t,e,r,n){if(e&&e[r]){var i=e[r];Object.keys(i).forEach(function(e){n(t,e,i[e])})}},a.checkType=function(t,e,n,i){const o=i.type,s=r.ElementUtils.getSupportedTypes(o);if(1===s.typeCount&&!s.any&&!s.other){const r=typeof n;if(s.array&&!Array.isArray(n)||s.object&&"object"!==r||s.string&&"string"!==r||s.number&&("number"!==r||!isFinite(n)))a.__ThrowTypeError(t,e,n,o);else if(s.boolean)return!!n}return n},a.__ThrowTypeError=function(t,e,n,i){throw new r.JetElementError(t,`Invalid type '${typeof n}' found for property '${e}'. Expected value of type '${i}'.`)},a.__CheckOverlappingAttribute=function(t,e){var n=e.split(".");if(n.length>1)for(n.pop();n.length;){var i=n.join(".");if(t.hasAttribute(i))throw new r.JetElementError(t,`Cannot set overlapping attributes '${e}' and '${i}'.`);n.pop()}},a.__InitProperties=function(t,e){const n=r.CustomElementUtils.getElementBridge(t);var o=r.CustomElementUtils.getElementProperties(t);if(o)for(var s=t.attributes,l=0;l<s.length;l++){var u=s[l],p=r.AttributeUtils.attributeToPropertyName(u.nodeName),c=i.getPropertyMetadata(p,o);if(c&&!c.readOnly)if(a.__CheckOverlappingAttribute(t,u.nodeName),!r.AttributeUtils.getExpressionInfo(u.value).expr){var d=a.__ParseAttrValue(t,u.nodeName,p,u.value,c);n.ValidateAndSetProperty(n.GetAliasForProperty.bind(n),e,p,d,t)}}},a.__SetProperty=function(t,e,r,n){var i,o=e,s=r.split("."),a=t(s[0]);s.length>1&&!e[a]&&(o=i={});for(var l=0;l<s.length;l++){var u=t(s[l]);l===s.length-1?o[u]=n:o[u]||(o[u]={}),o=o[u]}i&&(e[a]=i[a])},a.__ParseAttrValue=function(t,e,n,i,o){if(null==i)return i;function s(n){return r.AttributeUtils.attributeToPropertyValue(t,e,n,o)}var a=r.CustomElementUtils.getElementDescriptor(t.tagName).parseFunction;return a?a(i,n,o,function(t){return s(t)}):s(i)},a.__ProcessEventListeners=function(e){var n=t.CollectionUtils.copyInto({},e,void 0,!0,1);return n.properties=n.properties||{},a._enumerateMetadataForKey(null,n,"properties",function(t,e){var i=r.AttributeUtils.propertyNameToChangeEventType(e),o=r.AttributeUtils.eventTypeToEventListenerProperty(i);n.properties[o]={_derived:!0,_eventListener:!0}}),a._enumerateMetadataForKey(null,n,"events",function(t,e){var i=r.AttributeUtils.eventTypeToEventListenerProperty(e);n.properties[i]={_derived:!0,_eventListener:!0}}),n},a.__FirePropertyChangeEvent=function(t,e,n,i,o,s){var a=r.CustomElementUtils.getElementBridge(t);if(!a._SKIP_PROP_CHANGE_EVENT){var l={};s&&(l.subproperty=s),l.value=n,l.previousValue=i,l.updatedFrom=o,a.beforePropertyChangedEvent&&a.beforePropertyChangedEvent(t,e,l),("external"!==o||a.State.isComplete())&&t.dispatchEvent(new CustomEvent(e+"Changed",{detail:l}))}},a.__DefineDynamicObjectProperty=function(t,e,r,n){Object.defineProperty(t,e,{enumerable:!0,get:r,set:n})},a.DESC_KEY_META="metadata",t._registerLegacyNamespaceProp("BaseCustomElementBridge",a),o.whenDocumentReady().then(function(){!function(){var t=document.createElement("div");t.style.border="1px solid",t.style.borderColor="red green",t.style.position="absolute",t.style.top="-999px",t.style.backgroundImage="url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=)";var e=document.body;e.appendChild(t);var r=window.getComputedStyle(t),n=r.backgroundImage;r.borderTopColor!==r.borderRightColor&&(null==n||"none"!==n&&"url (invalid-url:)"!==n)||e.classList.add("oj-hicontrast"),e.removeChild(t)}()}),o.whenDocumentReady().then(function(){!function(){let t=[];const e=s.AgentUtils.getAgentInfo();t.push("oj-agent-os-"+e.os.toLowerCase()),t.push("oj-agent-browser-"+e.browser.toLowerCase()),document.documentElement.classList.add(...t)}()})});
//# sourceMappingURL=ojcustomelement.js.map